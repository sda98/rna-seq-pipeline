# End-to-End RNA-seq Workflow in R & Linux  
_From FASTQ → counts → differential expression → enrichment analysis_

## 1. Overview

This repository contains a simple, end-to-end **RNA-seq analysis pipeline** built with **bash + R**.  
It shows how to go from **raw FASTQ files** to:

- Quality control (QC)
- Read alignment and gene-level counts
- Differential expression analysis (**DESeq2**)
- Basic visualization (PCA, heatmaps, volcano plots)
- Functional enrichment (Gene Ontology / pathways)

The goal is to provide a **clear, reproducible example** of how I typically analyze RNA-seq data in real research projects.

> ✅ This is a **generic workflow** using a small public dataset (no proprietary or sensitive data).

---

## 2. Workflow summary

High-level steps:

1. **QC of raw reads** – FastQC (+ optional MultiQC)
2. **Trimming** – remove low-quality bases/adapters
3. **Alignment** – map reads to a reference genome
4. **Counting** – summarize reads to gene-level counts
5. **DE analysis in R** – using DESeq2
6. **Visualization** – PCA, heatmap, volcano plots
7. **Enrichment** – GO / pathway analysis from DE results

---

## 3. Repository structure

```text
rna-seq-end-to-end/
├─ data/
│  ├─ raw/                # FASTQ files (not tracked; download instructions below)
│  ├─ metadata/           # sample metadata (CSV/TSV)
│  └─ reference/          # reference genome / annotation (or links)
├─ scripts/
│  ├─ 01_qc.sh            # run FastQC (and MultiQC)
│  ├─ 02_trim.sh          # optional trimming
│  ├─ 03_align.sh         # alignment to reference
│  └─ 04_count.sh         # counting reads per gene
├─ R/
│  ├─ 01_deseq2_analysis.R      # DESeq2 workflow (PCA, DE, plots)
│  └─ 02_enrichment_analysis.R  # GO / pathway analysis
├─ results/
│  ├─ qc/
│  ├─ counts/
│  ├─ deseq2/
│  ├─ enrichment/
│  └─ figures/
└─ docs/
   └─ results_summary.md   # short written summary of the analysis


---

## 4. Requirements

### OS and command-line tools

- Linux/Unix environment
- `bash`
- FastQC
- A short-read aligner: HISAT2 
- `samtools`
- `featureCounts` or `htseq-count`
- `gzip`, `wget` or `curl`

### R and packages

- R ≥ 4.x
- Recommended packages:
  - DESeq2
  - ggplot2
  - pheatmap or ComplexHeatmap
  - clusterProfiler (or similar enrichment package)
  - An organism annotation package (e.g., org.Hs.eg.db or org.Mm.eg.db)
  - EnhancedVolcano (optional)
  - dplyr, tibble, readr, stringr

You can record the exact R environment in your analysis scripts using:

```r
sessionInfo()

---

# 5. Example dataset

This workflow is demonstrated on a small public RNA-seq dataset so that it can be run on a laptop.

- Source: a public GEO/SRA RNA-seq experiment
- Organism: typically Mus musculus or Homo sapiens
- Design: at least two conditions with biological replicates

To keep the repository lightweight, FASTQ files are not stored here.
Instead, a small download script (e.g., scripts/00_download_data.sh) or short instructions can be used to retrieve the data from public archives.

---

# 6. Quick start

# 6.1 Clone this repository

git clone https://github.com/YOUR_USERNAME/rna-seq-end-to-end.git
cd rna-seq-end-to-end

# 6.2. Download repository

git clone https://github.com/YOUR_USERNAME/rna-seq-end-to-end.git
cd rna-seq-end-to-end

# 6.3. Run the command lines

# 1) QC of raw reads
bash scripts/01_qc.sh

# 2) (Optional) trimming
bash scripts/02_trim.sh

# 3) Alignment to reference genome
bash scripts/03_align.sh

# 4) Count reads per gene
bash scripts/04_count.sh

These steps should produce aligned BAM files and a gene-level count matrix under results/.

# 6.4. Run DESeq2 and visualization (R)

From the project root, start R (or RStudio) and run:

source("R/01_deseq2_analysis.R")

This script should:

- Load the count matrix and sample metadata
- Run DESeq2
- Save results and plots into results/deseq2/ and results/figures/

# 6.5. Run enrichment analysis (R)

source("R/02_enrichment_analysis.R")

This script should:

- Take a list of differentially expressed genes
- Perform GO / pathway enrichment
- Save tables and plots into results/enrichment/

# 7. Outputs

After running the full workflow, you should see:

- QC reports in results/qc/
- Aligned reads (BAM files) in results/alignments/
- Gene counts in results/counts/
- Differential expression results in results/deseq2/
- Figures (e.g., PCA, volcano plots, heatmaps) in results/figures/
- Enrichment tables and plots in results/enrichment/

A short written interpretation of the results can be placed in docs/results_summary.md.

# 8. Reproducibility notes

The pipeline is intended for a fresh Linux/R environment with the listed tools installed. 
If you change dataset or species, update:

- Sample metadata
- Reference genome and annotation
- Organism-specific R annotation packages
- For strict reproducibility, set random seeds in your R scripts and document software versions in the README or a separate environment file.

# 9. Author

Author: Sergey Dadoyan
Contact: [[LinkedIn](https://www.linkedin.com/in/sergey-dadoyan-msc/)]; serg.dado98@gmail.com

If you find this workflow useful or have suggestions for improvement, feel free to open an issue or reach out.

